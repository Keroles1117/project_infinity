<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Infinity - منصة تعليمية</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Tajawal', sans-serif;
    }
    .gradient-bg {
      background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
    }
    .card-gradient {
      background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
      backdrop-filter: blur(10px);
    }
    .glow {
      box-shadow: 0 0 40px rgba(124, 58, 237, 0.3);
    }
    .infinity-logo {
      background: linear-gradient(135deg, #a855f7 0%, #6366f1 50%, #3b82f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .btn-primary {
      background: linear-gradient(135deg, #a855f7 0%, #6366f1 100%);
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(124, 58, 237, 0.4);
    }
    .course-card {
      transition: all 0.3s ease;
    }
    .course-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .float-animation {
      animation: float 3s ease-in-out infinite;
    }
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.4); }
      50% { box-shadow: 0 0 40px rgba(168, 85, 247, 0.6); }
    }
    .pulse-glow {
      animation: pulse-glow 2s ease-in-out infinite;
    }
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
    }
    .video-container video,
    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .toast {
      animation: slideIn 0.3s ease;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    .animate-spin {
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .upload-area {
      border: 2px dashed rgba(255,255,255,0.3);
      border-radius: 1rem;
      background: rgba(255,255,255,0.05);
      transition: all 0.3s ease;
      min-height: 200px;
    }
    .upload-area:hover {
      border-color: #a855f7;
      background: rgba(168, 85, 247, 0.05);
    }
    .upload-area.dragover {
      border-color: #6366f1;
      background: rgba(99, 102, 241, 0.1);
    }
    .file-preview {
      background: rgba(255,255,255,0.1);
      border-radius: 0.75rem;
      padding: 1rem;
      margin-top: 1rem;
    }
    .progress-bar {
      height: 8px;
      background: linear-gradient(90deg, #a855f7, #6366f1);
      border-radius: 4px;
      transition: width 0.3s ease;
    }
  </style>
 </head>
 <body class="h-full gradient-bg text-white overflow-auto">
  <div id="app" class="min-h-full">
   <!-- Toast Container -->
   <div id="toast-container" class="fixed top-4 left-4 z-50 flex flex-col gap-2"></div>
   
   <!-- Header -->
   <header class="sticky top-0 z-40 bg-black/30 backdrop-blur-lg border-b border-white/10">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
     <div class="flex items-center gap-3 cursor-pointer" onclick="showPage('home')">
      <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center float-animation">
       <span class="text-2xl font-bold">∞</span>
      </div>
      <h1 id="site-title" class="text-2xl font-bold infinity-logo">Infinity</h1>
     </div>
     <nav class="flex items-center gap-4">
      <button onclick="showPage('home')" class="px-4 py-2 rounded-lg hover:bg-white/10 transition">الرئيسية</button>
      <button onclick="showPage('courses')" class="px-4 py-2 rounded-lg hover:bg-white/10 transition">الكورسات</button>
      <button onclick="showAdminLogin()" class="px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 transition flex items-center gap-2">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
       </svg>
       <span>المشرف</span>
      </button>
     </nav>
    </div>
   </header>
   
   <!-- Main Content -->
   <main id="main-content" class="max-w-7xl mx-auto px-4 py-8">
    <!-- Home Page -->
    <div id="home-page">
     <div class="text-center py-16">
      <div class="inline-block mb-8">
       <div class="w-32 h-32 mx-auto rounded-3xl bg-gradient-to-br from-purple-500 via-indigo-500 to-blue-500 flex items-center justify-center pulse-glow">
        <span class="text-6xl font-bold">∞</span>
       </div>
      </div>
      <h2 id="welcome-text" class="text-4xl md:text-5xl font-bold mb-6">مرحباً بك في منصة <span class="infinity-logo">Infinity</span> التعليمية</h2>
      <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">منصتك الأولى لتعلم علوم الحاسوب - Data Structure &amp; Logic Design</p>
      <button onclick="showPage('courses')" class="btn-primary px-8 py-4 rounded-xl text-lg font-bold">استكشف الكورسات</button>
     </div>
     
     <!-- Features -->
     <div class="grid md:grid-cols-3 gap-6 mt-12">
      <div class="card-gradient rounded-2xl p-6 border border-white/10">
       <div class="w-14 h-14 rounded-xl bg-purple-500/20 flex items-center justify-center mb-4">
        <svg class="w-7 h-7 text-purple-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
        </svg>
       </div>
       <h3 class="text-xl font-bold mb-2">Data Structure</h3>
       <p class="text-gray-400">تعلم هياكل البيانات من الصفر حتى الاحتراف</p>
      </div>
      <div class="card-gradient rounded-2xl p-6 border border-white/10">
       <div class="w-14 h-14 rounded-xl bg-indigo-500/20 flex items-center justify-center mb-4">
        <svg class="w-7 h-7 text-indigo-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />
        </svg>
       </div>
       <h3 class="text-xl font-bold mb-2">Logic Design</h3>
       <p class="text-gray-400">أساسيات التصميم المنطقي والدوائر الرقمية</p>
      </div>
      <div class="card-gradient rounded-2xl p-6 border border-white/10">
       <div class="w-14 h-14 rounded-xl bg-blue-500/20 flex items-center justify-center mb-4">
        <svg class="w-7 h-7 text-blue-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
        </svg>
       </div>
       <h3 class="text-xl font-bold mb-2">فيديوهات عالية الجودة</h3>
       <p class="text-gray-400">محتوى مرئي احترافي وشرح مبسط</p>
      </div>
     </div>
    </div>
    
    <!-- Courses Page -->
    <div id="courses-page" class="hidden">
     <h2 class="text-3xl font-bold mb-8">الكورسات المتاحة</h2>
     
     <!-- Course Tabs -->
     <div class="flex gap-4 mb-8">
      <button onclick="filterCourses('all')" id="tab-all" class="px-6 py-3 rounded-xl bg-purple-500/20 border border-purple-500/50 font-bold transition hover:bg-purple-500/30">جميع الكورسات</button>
      <button onclick="filterCourses('data-structure')" id="tab-data-structure" class="px-6 py-3 rounded-xl bg-white/5 border border-white/10 font-bold transition hover:bg-white/10">Data Structure</button>
      <button onclick="filterCourses('logic')" id="tab-logic" class="px-6 py-3 rounded-xl bg-white/5 border border-white/10 font-bold transition hover:bg-white/10">Logic Design</button>
     </div>
     
     <!-- Videos Grid -->
     <div id="videos-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Videos will be loaded here -->
     </div>
    </div>
    
    <!-- Video Player Page -->
    <div id="video-page" class="hidden">
     <button onclick="showPage('courses')" class="flex items-center gap-2 text-gray-400 hover:text-white mb-6 transition">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      العودة للكورسات
     </button>
     <div id="video-content" class="card-gradient rounded-2xl border border-white/10 overflow-hidden">
      <!-- Video will be loaded here -->
     </div>
    </div>
    
    <!-- Admin Login Modal -->
    <div id="admin-login-modal" class="hidden fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
     <div class="card-gradient rounded-2xl border border-white/10 p-8 w-full max-w-md">
      <div class="text-center mb-6">
       <div class="w-16 h-16 mx-auto rounded-xl bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center mb-4">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewbox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
        </svg>
       </div>
       <h3 class="text-2xl font-bold">تسجيل دخول المشرف</h3>
      </div>
      <form id="admin-login-form" onsubmit="handleAdminLogin(event)">
       <div class="mb-4">
        <label class="block text-gray-300 mb-2">اسم المستخدم</label>
        <input type="text" id="admin-username" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition" placeholder="أدخل اسم المستخدم" required>
       </div>
       <div class="mb-6">
        <label class="block text-gray-300 mb-2">كلمة المرور</label>
        <input type="password" id="admin-password" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition" placeholder="أدخل كلمة المرور" required>
       </div>
       <div id="admin-login-error" class="hidden mb-4 p-3 rounded-lg bg-red-500/20 border border-red-500/50 text-red-300 text-center"></div>
       <button type="submit" id="admin-login-btn" class="w-full btn-primary py-3 rounded-xl font-bold">دخول</button>
      </form>
      <button onclick="closeAdminLogin()" class="mt-4 w-full py-3 rounded-xl border border-white/10 hover:bg-white/5 transition">إلغاء</button>
     </div>
    </div>
    
    <!-- Course Password Modal -->
    <div id="course-password-modal" class="hidden fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
     <div class="card-gradient rounded-2xl border border-white/10 p-8 w-full max-w-md">
      <div class="text-center mb-6">
       <div class="w-16 h-16 mx-auto rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center mb-4">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewbox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
        </svg>
       </div>
       <h3 class="text-2xl font-bold">أدخل كلمة مرور الكورس</h3>
       <p id="course-name-display" class="text-gray-400 mt-2"></p>
      </div>
      <form id="course-password-form" onsubmit="handleCoursePassword(event)">
       <div class="mb-6">
        <input type="password" id="course-password-input" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition text-center text-lg" placeholder="كلمة المرور" required>
       </div>
       <div id="course-password-error" class="hidden mb-4 p-3 rounded-lg bg-red-500/20 border border-red-500/50 text-red-300 text-center"></div>
       <button type="submit" class="w-full btn-primary py-3 rounded-xl font-bold">مشاهدة</button>
      </form>
      <button onclick="closeCoursePassword()" class="mt-4 w-full py-3 rounded-xl border border-white/10 hover:bg-white/5 transition">إلغاء</button>
     </div>
    </div>
    
    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="hidden">
     <div class="flex items-center justify-between mb-8">
      <h2 class="text-3xl font-bold">لوحة تحكم المشرف</h2>
      <button onclick="logoutAdmin()" class="px-4 py-2 rounded-xl bg-red-500/20 border border-red-500/50 hover:bg-red-500/30 transition flex items-center gap-2">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
       </svg>
       تسجيل خروج
      </button>
     </div>
     
     <!-- Stats -->
     <div class="grid md:grid-cols-3 gap-6 mb-8">
      <div class="card-gradient rounded-2xl border border-white/10 p-6">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-xl bg-green-500/20 flex items-center justify-center">
            <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
            </svg>
          </div>
          <div>
            <p class="text-gray-400">إجمالي الفيديوهات</p>
            <p class="text-2xl font-bold" id="total-videos">0</p>
          </div>
        </div>
      </div>
      <div class="card-gradient rounded-2xl border border-white/10 p-6">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center">
            <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <p class="text-gray-400">Data Structure</p>
            <p class="text-2xl font-bold" id="ds-videos">0</p>
          </div>
        </div>
      </div>
      <div class="card-gradient rounded-2xl border border-white/10 p-6">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center">
            <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <p class="text-gray-400">Logic Design</p>
            <p class="text-2xl font-bold" id="logic-videos">0</p>
          </div>
        </div>
      </div>
     </div>
     
     <!-- Add Video Form -->
     <div class="card-gradient rounded-2xl border border-white/10 p-6 mb-8">
      <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
       <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
       </svg>
       إضافة فيديو جديد
      </h3>
      <form id="add-video-form" onsubmit="handleAddVideo(event)">
       <div class="grid md:grid-cols-2 gap-4 mb-4">
        <div>
         <label class="block text-gray-300 mb-2">عنوان الفيديو</label>
         <input type="text" id="video-title" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition" placeholder="أدخل عنوان الفيديو" required>
        </div>
        <div>
         <label class="block text-gray-300 mb-2">الكورس</label>
         <select id="video-course" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition" required>
          <option value="">اختر الكورس</option>
          <option value="data-structure">Data Structure</option>
          <option value="logic">Logic Design</option>
         </select>
        </div>
       </div>
       <div class="mb-4">
        <label class="block text-gray-300 mb-2">وصف الفيديو</label>
        <textarea id="video-description" rows="2" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition" placeholder="أدخل وصف مختصر للفيديو"></textarea>
       </div>
       
       <!-- Video Source Selection -->
       <div class="mb-4">
        <label class="block text-gray-300 mb-2">مصدر الفيديو</label>
        <div class="flex gap-2 mb-4">
         <button type="button" onclick="switchVideoSource('youtube')" id="btn-youtube-source" class="px-4 py-2 rounded-lg bg-purple-500/30 border border-purple-500/50 font-bold transition">YouTube</button>
         <button type="button" onclick="switchVideoSource('upload')" id="btn-upload-source" class="px-4 py-2 rounded-lg bg-white/5 border border-white/10 font-bold transition hover:bg-white/10">رفع فيديو</button>
        </div>
        
        <!-- YouTube Source -->
        <div id="youtube-source">
         <label class="block text-gray-300 mb-2">رابط YouTube</label>
         <input type="url" id="video-youtube-url" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition" placeholder="https://youtube.com/watch?v=... أو معرف الفيديو فقط" required>
         <p class="text-sm text-gray-500 mt-1">أدخل رابط YouTube كامل أو معرف الفيديو فقط (11 حرف)</p>
        </div>
        
        <!-- File Upload -->
        <div id="upload-source" class="hidden">
         <label class="block text-gray-300 mb-2">رفع ملف فيديو</label>
         <div id="upload-area" class="upload-area flex flex-col items-center justify-center p-8 cursor-pointer" onclick="document.getElementById('video-file').click()">
           <svg class="w-16 h-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
           </svg>
           <p class="text-gray-400 mb-2">اضغط أو اسحب وأفلت ملف الفيديو هنا</p>
           <p class="text-sm text-gray-500">الحجم الأقصى: 100MB | المدعوم: MP4, WebM, MOV</p>
           <input type="file" id="video-file" class="hidden" accept="video/*,.mp4,.webm,.mov" onchange="handleFileSelect(event)">
         </div>
         <div id="file-preview" class="file-preview hidden">
           <div class="flex items-center justify-between">
             <div>
               <p class="font-medium" id="file-name"></p>
               <p class="text-sm text-gray-400" id="file-size"></p>
             </div>
             <button type="button" onclick="removeFile()" class="text-red-400 hover:text-red-300">
               <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
               </svg>
             </button>
           </div>
           <div class="mt-4">
             <div class="flex justify-between text-sm mb-1">
               <span>جاهز للرفع</span>
               <span id="upload-percentage">0%</span>
             </div>
             <div class="w-full bg-white/10 rounded-full h-2">
               <div id="upload-progress" class="progress-bar h-2 rounded-full" style="width: 0%"></div>
             </div>
           </div>
         </div>
        </div>
       </div>
       
       <div class="mb-6">
        <label class="block text-gray-300 mb-2">كلمة مرور الكورس</label>
        <input type="text" id="video-password" class="w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 focus:outline-none transition" placeholder="كلمة مرور للوصول للفيديو" required>
        <p class="text-sm text-gray-500 mt-1">يجب على الطالب إدخال هذه الكلمة لمشاهدة الفيديو</p>
       </div>
       
       <button type="submit" id="add-video-btn" class="btn-primary px-6 py-3 rounded-xl font-bold flex items-center justify-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
        </svg>
        إضافة الفيديو
       </button>
      </form>
     </div>
     
     <!-- Videos List -->
     <div class="card-gradient rounded-2xl border border-white/10 p-6">
      <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
       <svg class="w-6 h-6 text-indigo-400" fill="none" stroke="currentColor" viewbox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
       </svg>
       الفيديوهات المضافة
      </h3>
      <div id="admin-videos-list">
       <!-- Videos will be loaded here -->
      </div>
     </div>
    </div>
   </main>
   
   <!-- Footer -->
   <footer class="border-t border-white/10 mt-auto">
    <div class="max-w-7xl mx-auto px-4 py-6 text-center text-gray-400">
     <p>© 2024 Infinity - جميع الحقوق محفوظة</p>
    </div>
   </footer>
  </div>
  
  <script>
    // ===========================================
    // SIMPLE VIDEO BACKEND - WORKING VERSION
    // ===========================================
    
    class SimpleVideoBackend {
      constructor() {
        this.VIDEOS_KEY = 'infinity_videos_simple';
        this.MAX_FILE_SIZE = 100 * 1024 * 1024; // 100MB
        this.initStorage();
      }
      
      initStorage() {
        if (!localStorage.getItem(this.VIDEOS_KEY)) {
          localStorage.setItem(this.VIDEOS_KEY, JSON.stringify([]));
        }
      }
      
      getVideos() {
        try {
          return JSON.parse(localStorage.getItem(this.VIDEOS_KEY)) || [];
        } catch {
          return [];
        }
      }
      
      getVideo(id) {
        const videos = this.getVideos();
        return videos.find(v => v.id === id);
      }
      
      async saveVideo(videoData) {
        try {
          const videos = this.getVideos();
          const newVideo = {
            id: Date.now().toString(),
            ...videoData,
            created_at: new Date().toISOString(),
            views: 0
          };
          
          videos.push(newVideo);
          localStorage.setItem(this.VIDEOS_KEY, JSON.stringify(videos));
          
          this.updateStats();
          
          return {
            success: true,
            data: newVideo,
            message: 'تم حفظ الفيديو بنجاح'
          };
        } catch (error) {
          console.error('Save video error:', error);
          return {
            success: false,
            message: 'حدث خطأ في حفظ الفيديو'
          };
        }
      }
      
      async deleteVideo(id) {
        try {
          let videos = this.getVideos();
          videos = videos.filter(v => v.id !== id);
          localStorage.setItem(this.VIDEOS_KEY, JSON.stringify(videos));
          
          this.updateStats();
          
          return {
            success: true,
            message: 'تم حذف الفيديو بنجاح'
          };
        } catch (error) {
          return {
            success: false,
            message: 'حدث خطأ في حذف الفيديو'
          };
        }
      }
      
      incrementViews(id) {
        try {
          const videos = this.getVideos();
          const index = videos.findIndex(v => v.id === id);
          if (index !== -1) {
            videos[index].views = (videos[index].views || 0) + 1;
            localStorage.setItem(this.VIDEOS_KEY, JSON.stringify(videos));
          }
        } catch (error) {
          console.error('Error updating views:', error);
        }
      }
      
      updateStats() {
        const videos = this.getVideos();
        const stats = {
          total: videos.length,
          data_structure: videos.filter(v => v.course === 'data-structure').length,
          logic_design: videos.filter(v => v.course === 'logic').length
        };
        
        if (document.getElementById('total-videos')) {
          document.getElementById('total-videos').textContent = stats.total;
          document.getElementById('ds-videos').textContent = stats.data_structure;
          document.getElementById('logic-videos').textContent = stats.logic_design;
        }
        
        return stats;
      }
    }
    
    // ===========================================
    // GLOBAL VARIABLES
    // ===========================================
    
    const ADMIN_USERNAME = 'admin';
    const ADMIN_PASSWORD = 'infinity2024';
    const backend = new SimpleVideoBackend();
    
    let isAdminLoggedIn = false;
    let currentFilter = 'all';
    let selectedVideoId = null;
    let currentVideoSource = 'youtube';
    let selectedFile = null;
    let uploadProgressInterval = null;
    
    // ===========================================
    // UTILITY FUNCTIONS
    // ===========================================
    
    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast px-4 py-3 rounded-lg flex items-center gap-2 ${
        type === 'success' ? 'bg-green-500/90' : 
        type === 'error' ? 'bg-red-500/90' : 'bg-blue-500/90'
      }`;
      toast.innerHTML = `
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          ${type === 'success' ? 
            '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>' :
            type === 'error' ?
            '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>' :
            '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>'
          }
        </svg>
        <span>${message}</span>
      `;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }
    
    function extractYouTubeId(url) {
      const patterns = [
        /[?&]v=([a-zA-Z0-9_-]{11})/,
        /youtu\.be\/([a-zA-Z0-9_-]{11})/,
        /\/embed\/([a-zA-Z0-9_-]{11})/,
        /^([a-zA-Z0-9_-]{11})$/
      ];
      
      for (const pattern of patterns) {
        const match = url.match(pattern);
        if (match) return match[1];
      }
      return null;
    }
    
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    function startUploadProgress() {
      let progress = 0;
      clearInterval(uploadProgressInterval);
      
      uploadProgressInterval = setInterval(() => {
        progress += 5;
        if (progress > 95) {
          clearInterval(uploadProgressInterval);
          return;
        }
        
        document.getElementById('upload-progress').style.width = `${progress}%`;
        document.getElementById('upload-percentage').textContent = `${progress}%`;
      }, 100);
    }
    
    function completeUploadProgress() {
      clearInterval(uploadProgressInterval);
      document.getElementById('upload-progress').style.width = '100%';
      document.getElementById('upload-percentage').textContent = '100%';
    }
    
    function resetUploadProgress() {
      clearInterval(uploadProgressInterval);
      document.getElementById('upload-progress').style.width = '0%';
      document.getElementById('upload-percentage').textContent = '0%';
    }
    
    // ===========================================
    // FILE UPLOAD HANDLING
    // ===========================================
    
    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      if (!file.type.startsWith('video/')) {
        showToast('الرجاء اختيار ملف فيديو صحيح', 'error');
        return;
      }
      
      if (file.size > backend.MAX_FILE_SIZE) {
        showToast('حجم الملف يجب أن يكون أقل من 100MB', 'error');
        return;
      }
      
      selectedFile = file;
      
      // إظهار معاينة الملف
      document.getElementById('file-preview').classList.remove('hidden');
      document.getElementById('file-name').textContent = file.name;
      document.getElementById('file-size').textContent = formatFileSize(file.size);
      
      resetUploadProgress();
      
      showToast('تم اختيار الملف، جاهز للرفع');
    }
    
    function removeFile() {
      selectedFile = null;
      document.getElementById('file-preview').classList.add('hidden');
      document.getElementById('video-file').value = '';
      resetUploadProgress();
      showToast('تم إزالة الملف', 'info');
    }
    
    // ===========================================
    // DRAG AND DROP HANDLING
    // ===========================================
    
    function initDragAndDrop() {
      const uploadArea = document.getElementById('upload-area');
      
      ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, preventDefaults, false);
      });
      
      function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
      }
      
      ['dragenter', 'dragover'].forEach(eventName => {
        uploadArea.addEventListener(eventName, highlight, false);
      });
      
      ['dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, unhighlight, false);
      });
      
      function highlight() {
        uploadArea.classList.add('dragover');
      }
      
      function unhighlight() {
        uploadArea.classList.remove('dragover');
      }
      
      uploadArea.addEventListener('drop', handleDrop, false);
      
      function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        
        if (files.length > 0) {
          const fileInput = document.getElementById('video-file');
          fileInput.files = files;
          
          // تشغيل حدث change يدوياً
          const event = new Event('change', { bubbles: true });
          fileInput.dispatchEvent(event);
        }
      }
    }
    
    // ===========================================
    // PAGE NAVIGATION
    // ===========================================
    
    function showPage(page) {
      document.getElementById('home-page').classList.add('hidden');
      document.getElementById('courses-page').classList.add('hidden');
      document.getElementById('video-page').classList.add('hidden');
      document.getElementById('admin-dashboard').classList.add('hidden');
      
      if (page === 'home') {
        document.getElementById('home-page').classList.remove('hidden');
      } else if (page === 'courses') {
        document.getElementById('courses-page').classList.remove('hidden');
        renderVideosGrid();
      } else if (page === 'video') {
        document.getElementById('video-page').classList.remove('hidden');
      } else if (page === 'admin') {
        document.getElementById('admin-dashboard').classList.remove('hidden');
        renderAdminVideosList();
        backend.updateStats();
      }
    }
    
    // ===========================================
    // ADMIN LOGIN
    // ===========================================
    
    function showAdminLogin() {
      if (isAdminLoggedIn) {
        showPage('admin');
        return;
      }
      document.getElementById('admin-login-modal').classList.remove('hidden');
      document.getElementById('admin-username').focus();
    }
    
    function closeAdminLogin() {
      document.getElementById('admin-login-modal').classList.add('hidden');
      document.getElementById('admin-login-form').reset();
      document.getElementById('admin-login-error').classList.add('hidden');
    }
    
    function handleAdminLogin(e) {
      e.preventDefault();
      const username = document.getElementById('admin-username').value;
      const password = document.getElementById('admin-password').value;
      const errorEl = document.getElementById('admin-login-error');
      
      if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
        isAdminLoggedIn = true;
        closeAdminLogin();
        showPage('admin');
        showToast('تم تسجيل الدخول بنجاح');
      } else {
        errorEl.textContent = 'اسم المستخدم أو كلمة المرور غير صحيحة';
        errorEl.classList.remove('hidden');
      }
    }
    
    function logoutAdmin() {
      isAdminLoggedIn = false;
      showPage('home');
      showToast('تم تسجيل الخروج');
    }
    
    // ===========================================
    // VIDEO SOURCE HANDLING
    // ===========================================
    
    function switchVideoSource(source) {
      currentVideoSource = source;
      
      document.getElementById('youtube-source').classList.add('hidden');
      document.getElementById('upload-source').classList.add('hidden');
      
      document.getElementById('btn-youtube-source').classList.remove('bg-purple-500/30', 'border-purple-500/50');
      document.getElementById('btn-upload-source').classList.remove('bg-purple-500/30', 'border-purple-500/50');
      
      document.getElementById('btn-youtube-source').classList.add('bg-white/5', 'border-white/10');
      document.getElementById('btn-upload-source').classList.add('bg-white/5', 'border-white/10');
      
      if (source === 'youtube') {
        document.getElementById('youtube-source').classList.remove('hidden');
        document.getElementById('btn-youtube-source').classList.remove('bg-white/5', 'border-white/10');
        document.getElementById('btn-youtube-source').classList.add('bg-purple-500/30', 'border-purple-500/50');
      } else if (source === 'upload') {
        document.getElementById('upload-source').classList.remove('hidden');
        document.getElementById('btn-upload-source').classList.remove('bg-white/5', 'border-white/10');
        document.getElementById('btn-upload-source').classList.add('bg-purple-500/30', 'border-purple-500/50');
      }
    }
    
    // ===========================================
    // ADD VIDEO - SIMPLE WORKING VERSION
    // ===========================================
    
    async function handleAddVideo(e) {
      e.preventDefault();
      
      const btn = document.getElementById('add-video-btn');
      const originalText = btn.innerHTML;
      btn.disabled = true;
      btn.innerHTML = '<span class="animate-spin">⏳</span> جاري الإضافة...';
      
      try {
        // جمع بيانات الفيديو
        const title = document.getElementById('video-title').value.trim();
        const description = document.getElementById('video-description').value.trim();
        const course = document.getElementById('video-course').value;
        const password = document.getElementById('video-password').value.trim();
        
        // التحقق من البيانات
        if (!title || !course || !password) {
          showToast('الرجاء ملء جميع الحقول المطلوبة', 'error');
          btn.disabled = false;
          btn.innerHTML = originalText;
          return;
        }
        
        let videoData = {
          title,
          description,
          course,
          course_password: password,
          views: 0
        };
        
        // معالجة مصدر الفيديو
        if (currentVideoSource === 'youtube') {
          const youtubeUrl = document.getElementById('video-youtube-url').value.trim();
          const youtubeId = extractYouTubeId(youtubeUrl);
          
          if (!youtubeId) {
            showToast('رابط YouTube غير صالح. أدخل رابطاً صحيحاً أو معرف الفيديو فقط', 'error');
            btn.disabled = false;
            btn.innerHTML = originalText;
            return;
          }
          
          videoData.source_type = 'youtube';
          videoData.video_url = `https://www.youtube.com/embed/${youtubeId}`;
          videoData.video_id = youtubeId;
          
        } else if (currentVideoSource === 'upload') {
          if (!selectedFile) {
            showToast('الرجاء اختيار ملف فيديو أولاً', 'error');
            btn.disabled = false;
            btn.innerHTML = originalText;
            return;
          }
          
          // بدء محاكاة الرفع
          startUploadProgress();
          
          // إنشاء Data URL للملف (لأغراض العرض فقط)
          const reader = new FileReader();
          
          await new Promise((resolve, reject) => {
            reader.onload = () => {
              videoData.source_type = 'local';
              videoData.video_url = reader.result; // Data URL
              videoData.file_name = selectedFile.name;
              videoData.file_size = selectedFile.size;
              videoData.file_type = selectedFile.type;
              
              completeUploadProgress();
              resolve();
            };
            
            reader.onerror = () => {
              reject(new Error('فشل في قراءة الملف'));
            };
            
            reader.readAsDataURL(selectedFile);
          });
        }
        
        // إضافة تأخير قصير لمحاكاة الرفع
        await new Promise(resolve => setTimeout(resolve, 500));
        
        // حفظ الفيديو
        const result = await backend.saveVideo(videoData);
        
        if (result.success) {
          // إعادة تعيين النموذج
          document.getElementById('add-video-form').reset();
          selectedFile = null;
          document.getElementById('file-preview').classList.add('hidden');
          document.getElementById('video-file').value = '';
          resetUploadProgress();
          
          // تحديث العرض
          renderAdminVideosList();
          backend.updateStats();
          
          showToast('تم إضافة الفيديو بنجاح');
        } else {
          showToast(result.message, 'error');
        }
        
      } catch (error) {
        console.error('Error adding video:', error);
        showToast('حدث خطأ غير متوقع', 'error');
      } finally {
        btn.disabled = false;
        btn.innerHTML = originalText;
      }
    }
    
    // ===========================================
    // RENDER ADMIN VIDEOS LIST
    // ===========================================
    
    function renderAdminVideosList() {
      const container = document.getElementById('admin-videos-list');
      const videos = backend.getVideos();
      
      if (videos.length === 0) {
        container.innerHTML = `
          <div class="text-center py-8 text-gray-400">
            <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-white/5 flex items-center justify-center">
              <svg class="w-8 h-8 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
            </div>
            <p>لا توجد فيديوهات مضافة</p>
            <p class="text-sm text-gray-500 mt-1">ابدأ بإضافة أول فيديو</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = videos.map(video => `
        <div class="flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/10 mb-3 hover:bg-white/10 transition" data-admin-video="${video.id}">
          <div class="flex items-center gap-4 flex-1">
            <div class="w-12 h-12 rounded-lg ${video.course === 'data-structure' ? 'bg-purple-500/20' : 'bg-indigo-500/20'} flex items-center justify-center">
              <svg class="w-6 h-6 ${video.course === 'data-structure' ? 'text-purple-400' : 'text-indigo-400'}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
            </div>
            <div class="flex-1">
              <h4 class="font-bold mb-1">${video.title}</h4>
              <div class="flex flex-wrap gap-2">
                <span class="text-xs px-2 py-1 rounded ${video.course === 'data-structure' ? 'bg-purple-500/20 text-purple-400' : 'bg-indigo-500/20 text-indigo-400'}">
                  ${video.course === 'data-structure' ? 'Data Structure' : 'Logic Design'}
                </span>
                <span class="text-xs px-2 py-1 rounded ${video.source_type === 'youtube' ? 'bg-red-500/20 text-red-400' : 'bg-green-500/20 text-green-400'}">
                  ${video.source_type === 'youtube' ? 'YouTube' : 'ملف محلي'}
                </span>
                ${video.source_type === 'local' ? `
                  <span class="text-xs px-2 py-1 rounded bg-blue-500/20 text-blue-400">
                    ${formatFileSize(video.file_size || 0)}
                  </span>
                ` : ''}
                <span class="text-xs px-2 py-1 rounded bg-gray-500/20 text-gray-400">
                  كلمة المرور: ${video.course_password}
                </span>
                <span class="text-xs px-2 py-1 rounded bg-blue-500/20 text-blue-400">
                  ${video.views || 0} مشاهدة
                </span>
              </div>
            </div>
          </div>
          <div class="flex gap-2">
            <button onclick="previewVideo('${video.id}')" class="p-2 rounded-lg bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 transition">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
              </svg>
            </button>
            <button onclick="deleteVideo('${video.id}')" class="p-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 transition">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
              </svg>
            </button>
          </div>
        </div>
      `).join('');
    }
    
    // ===========================================
    // PREVIEW VIDEO IN ADMIN
    // ===========================================
    
    function previewVideo(videoId) {
      const video = backend.getVideo(videoId);
      if (!video) return;
      
      selectedVideoId = videoId;
      
      document.getElementById('course-name-display').textContent = `معاينة: ${video.title}`;
      document.getElementById('course-password-input').value = video.course_password;
      document.getElementById('course-password-modal').classList.remove('hidden');
    }
    
    // ===========================================
    // DELETE VIDEO
    // ===========================================
    
    async function deleteVideo(videoId) {
      if (!confirm('هل أنت متأكد من حذف هذا الفيديو؟')) {
        return;
      }
      
      const result = await backend.deleteVideo(videoId);
      
      if (result.success) {
        renderAdminVideosList();
        renderVideosGrid();
        backend.updateStats();
        showToast('تم حذف الفيديو بنجاح');
      } else {
        showToast(result.message, 'error');
      }
    }
    
    // ===========================================
    // FILTER COURSES
    // ===========================================
    
    function filterCourses(filter) {
      currentFilter = filter;
      
      document.querySelectorAll('[id^="tab-"]').forEach(tab => {
        tab.classList.remove('bg-purple-500/20', 'border-purple-500/50');
        tab.classList.add('bg-white/5', 'border-white/10');
      });
      
      const activeTab = document.getElementById(`tab-${filter}`);
      activeTab.classList.remove('bg-white/5', 'border-white/10');
      activeTab.classList.add('bg-purple-500/20', 'border-purple-500/50');
      
      renderVideosGrid();
    }
    
    // ===========================================
    // RENDER VIDEOS GRID
    // ===========================================
    
    function renderVideosGrid() {
      const container = document.getElementById('videos-grid');
      let videos = backend.getVideos();
      
      if (currentFilter !== 'all') {
        videos = videos.filter(v => v.course === currentFilter);
      }
      
      if (videos.length === 0) {
        container.innerHTML = `
          <div class="text-center py-16 col-span-full">
            <div class="w-20 h-20 mx-auto rounded-full bg-white/5 flex items-center justify-center mb-4">
              <svg class="w-10 h-10 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
            </div>
            <p class="text-gray-400 text-lg">لا توجد فيديوهات حالياً</p>
            <p class="text-gray-500">سيتم إضافة الفيديوهات قريباً</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = videos.map(video => `
        <div class="course-card card-gradient rounded-2xl border border-white/10 overflow-hidden cursor-pointer" onclick="requestVideoAccess('${video.id}')">
          <div class="aspect-video ${video.course === 'data-structure' ? 'bg-gradient-to-br from-purple-900/50 to-indigo-900/50' : 'bg-gradient-to-br from-indigo-900/50 to-blue-900/50'} flex items-center justify-center relative">
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="w-16 h-16 rounded-full bg-white/20 flex items-center justify-center backdrop-blur">
                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M8 5v14l11-7z"/>
                </svg>
              </div>
            </div>
            <div class="absolute top-3 right-3 px-3 py-1 rounded-full ${video.course === 'data-structure' ? 'bg-purple-500/80' : 'bg-indigo-500/80'} text-sm font-bold">
              ${video.course === 'data-structure' ? 'Data Structure' : 'Logic'}
            </div>
            <div class="absolute bottom-3 left-3 flex items-center gap-1 px-2 py-1 rounded-lg bg-black/50 text-sm">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
              </svg>
              محمي
            </div>
            <div class="absolute top-3 left-3 flex items-center gap-1 px-2 py-1 rounded-lg bg-black/50 text-xs">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
              </svg>
              ${video.views || 0}
            </div>
            ${video.source_type === 'local' ? `
              <div class="absolute bottom-3 right-3 px-2 py-1 rounded-lg bg-black/50 text-xs">
                ${formatFileSize(video.file_size || 0)}
              </div>
            ` : ''}
          </div>
          <div class="p-4">
            <h3 class="font-bold text-lg mb-2 line-clamp-1">${video.title}</h3>
            <p class="text-gray-400 text-sm line-clamp-2">${video.description || 'لا يوجد وصف'}</p>
            <div class="flex items-center gap-2 mt-3">
              <span class="text-xs px-2 py-1 rounded ${video.source_type === 'youtube' ? 'bg-red-500/20 text-red-400' : 'bg-green-500/20 text-green-400'}">
                ${video.source_type === 'youtube' ? 'YouTube' : 'ملف محلي'}
              </span>
            </div>
          </div>
        </div>
      `).join('');
    }
    
    // ===========================================
    // VIDEO PASSWORD HANDLING
    // ===========================================
    
    function requestVideoAccess(videoId) {
      selectedVideoId = videoId;
      const video = backend.getVideo(videoId);
      
      if (!video) {
        showToast('الفيديو غير موجود', 'error');
        return;
      }
      
      document.getElementById('course-name-display').textContent = video.title;
      document.getElementById('course-password-modal').classList.remove('hidden');
      document.getElementById('course-password-input').value = '';
      document.getElementById('course-password-input').focus();
      document.getElementById('course-password-error').classList.add('hidden');
    }
    
    function closeCoursePassword() {
      document.getElementById('course-password-modal').classList.add('hidden');
      document.getElementById('course-password-form').reset();
      document.getElementById('course-password-error').classList.add('hidden');
      selectedVideoId = null;
    }
    
    function handleCoursePassword(e) {
      e.preventDefault();
      const password = document.getElementById('course-password-input').value;
      const video = backend.getVideo(selectedVideoId);
      const errorEl = document.getElementById('course-password-error');
      
      if (!video) {
        closeCoursePassword();
        showToast('الفيديو غير موجود', 'error');
        return;
      }
      
      if (password === video.course_password) {
        closeCoursePassword();
        playVideo(video);
        backend.incrementViews(video.id);
      } else {
        errorEl.textContent = 'كلمة المرور غير صحيحة';
        errorEl.classList.remove('hidden');
      }
    }
    
    // ===========================================
    // PLAY VIDEO
    // ===========================================
    
    function playVideo(video) {
      const videoContent = document.getElementById('video-content');
      let videoEmbed = '';
      
      if (video.source_type === 'youtube') {
        videoEmbed = `
          <div class="video-container">
            <iframe 
              src="https://www.youtube.com/embed/${video.video_id}?rel=0&modestbranding=1&autoplay=1" 
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
              allowfullscreen
              frameborder="0">
            </iframe>
          </div>
        `;
      } else if (video.source_type === 'local') {
        videoEmbed = `
          <div class="video-container">
            <video 
              controls 
              controlsList="nodownload" 
              autoplay
              style="width: 100%; height: 100%; background: #000;">
              <source src="${video.video_url}" type="${video.file_type || 'video/mp4'}">
              متصفحك لا يدعم تشغيل الفيديو
            </video>
          </div>
        `;
      } else {
        videoEmbed = `
          <div class="text-center p-8 bg-purple-500/20 border border-purple-500/50 rounded-lg">
            <svg class="w-16 h-16 mx-auto mb-4 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p class="text-yellow-300 text-lg font-bold mb-2">⚠️ نوع الفيديو غير مدعوم</p>
          </div>
        `;
      }
      
      videoContent.innerHTML = `
        <div class="p-4">
          <div class="mb-6">
            ${videoEmbed}
          </div>
          <div class="p-6">
            <div class="flex items-center gap-3 mb-4 flex-wrap">
              <span class="px-3 py-1 rounded-full ${video.course === 'data-structure' ? 'bg-purple-500/20 text-purple-400' : 'bg-indigo-500/20 text-indigo-400'} text-sm font-bold">
                ${video.course === 'data-structure' ? 'Data Structure' : 'Logic Design'}
              </span>
              ${video.source_type === 'youtube' ? 
                '<span class="px-3 py-1 rounded-full bg-red-500/20 text-red-400 text-sm font-bold">🔴 YouTube</span>' : 
                '<span class="px-3 py-1 rounded-full bg-green-500/20 text-green-400 text-sm font-bold">📁 ملف محلي</span>'}
              <span class="px-3 py-1 rounded-full bg-gray-500/20 text-gray-400 text-sm font-bold">
                👁️ ${video.views || 0} مشاهدة
              </span>
              ${video.source_type === 'local' ? 
                `<span class="px-3 py-1 rounded-full bg-blue-500/20 text-blue-400 text-sm font-bold">
                  ${formatFileSize(video.file_size || 0)}
                </span>` : ''}
            </div>
            <h2 class="text-2xl font-bold mb-4">${video.title}</h2>
            <p class="text-gray-400 leading-relaxed mb-6 whitespace-pre-line">${video.description || 'لا يوجد وصف'}</p>
            <div class="mt-5 pt-5 border-t border-white/10">
              <p class="text-xs text-gray-500">📅 ${new Date(video.created_at).toLocaleDateString('ar-SA', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
              })}</p>
            </div>
          </div>
        </div>
      `;
      
      showPage('video');
    }
    
    // ===========================================
    // INITIALIZATION
    // ===========================================
    
    function init() {
      // تهيئة السحب والإفلات
      if (document.getElementById('upload-area')) {
        initDragAndDrop();
      }
      
      // تحميل الإحصائيات
      backend.updateStats();
      
      // عرض الصفحة الرئيسية
      showPage('home');
      
      // رسالة ترحيب
      setTimeout(() => {
        showToast('مرحباً بك في منصة Infinity التعليمية');
      }, 1000);
    }
    
    // بدء التشغيل
    document.addEventListener('DOMContentLoaded', init);
  </script>
 </body>
</html>